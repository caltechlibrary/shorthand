<!DOCTYPE html>
<html>
<head>
    <title>Shorthand - the gory details</title>
    <link href='https://fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic' rel='stylesheet' type='text/css'>
    <link href="css/style.css" rel="stylesheet" />
<head>
<body>
    <header>
        <h1>Shorthand - the gory details</h1>
    </header>
    <section><h1>Assignments and Expansions</h1>

<p>Shorthand is a simple label expansion utility. It is based on a simple key value substitution.  It supports this following types of definitions</p>

<ul>
<li>Assign a string to a LABEL</li>
<li>Assign the contents of a file to a LABEL</li>
<li>Assign the output of a Bash shell expression to a LABEL</li>
<li>Assign the output of a shorthand expansion to a LABEL</li>
<li>Read a file of shorthand assignments and assign any expansions to the LABEL</li>
<li>Output a LABEL value to a file</li>
<li>Output all LABEL values to a file</li>
<li>Output a LABEL assignment statement to a file</li>
<li>Output all assignment statements to a file</li>
</ul>

<p><em>shorthand</em> replaces the LABEL with the value assigned to it whereever it is encountered in the text being passed. The assignment statement is not written to stdout output.</p>

<table>
<thead>
<tr>
<th>operator</th>
<th>meaning</th>
<th>example</th>
</tr>
</thead>

<tbody>
<tr>
<td>:=:</td>
<td>Assign String</td>
<td>@name :=: Freda</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:&lt;:</td>
<td>Assign the contents of a file</td>
<td>@content :&lt;: myfile.txt</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:}&lt;:</td>
<td>Get assignments from a file</td>
<td>_ :}&lt;: myfile.shorthand</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:{:</td>
<td>Assign an expansion</td>
<td>@reportTitle :{: Report: @title for @date</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:{{:</td>
<td>Assign expanded expansion</td>
<td>@reportHeading :{{: @reportTitle</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:{&lt;:</td>
<td>Include Expansion</td>
<td>@nav :{&lt;: mynav.html</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:!:</td>
<td>Assign Shell output</td>
<td>@date :!: date +%Y-%m-%d</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:{!:</td>
<td>Assign Expand then gete Shell output</td>
<td>@entry :{!: cat header.txt @filename footer.txt</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:[:</td>
<td>Assign Markdown processed text</td>
<td>@div :[: # My h1 for a Div</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:{[:</td>
<td>Assign Expanded Markdown</td>
<td>@div :{[: Greetings <strong>@name</strong></td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:[&lt;:</td>
<td>Include Markdown processed text</td>
<td>@nav :[&lt;: mynav.md</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:{[&lt;:</td>
<td>Include Expanded Markdown processed text</td>
<td>@nav :[&lt;: mynav.md</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:&gt;:</td>
<td>Output Assigned Expansion</td>
<td>@content :&gt;: content.txt</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:@&gt;:</td>
<td>Output all assigned Expansions</td>
<td>_ :@&gt;: contents.txt</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:}&gt;:</td>
<td>Output Assignment</td>
<td>@content :}&gt;: content.shorthand</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:@}&gt;:</td>
<td>Output all Assignments</td>
<td>_ :@}&gt;: contents.shorthand</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>

<tr>
<td>:exit:</td>
<td>Exit the shorthand repl</td>
<td>:exit:</td>
</tr>

<tr>
<td>&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
</tr>
</tbody>
</table>

<p>Notes: Using an underscore as a LABEL means the label will be ignored. There are no guarantees of order when writing values or assignment statements to a file.</p>

<p>The spaces surrounding &ldquo; :=: &ldquo;, &rdquo; :=&lt;: &ldquo;, &rdquo; :!: &ldquo;, &rdquo; :{: &ldquo;, &rdquo; :&gt;: &ldquo;, &rdquo; :*&gt;: &ldquo;, &rdquo; :}: &ldquo;, &rdquo; :}&gt;: &ldquo;, etc. are required.</p>

<h2>Example</h2>

<p>In this example a file containing the text of pre-amble is assigned to the label @PREAMBLE, the time 3:30 is assigned to the label @NOW.</p>

<pre><code class="language-text">    @PREAMBLE :=&lt;: /home/me/preamble.text
    @NOW :=: 3:30

    At @NOW I will be reading the @PREAMBLE until everyone falls asleep.
</code></pre>

<p>If the file preamble.txt contained the phrase &ldquo;Hello World&rdquo; (including the quotes but without any carriage return or line feed) the output after processing the shorthand would look like -</p>

<pre><code class="language-text">
    At 3:30 I will be reading the &quot;Hello World&quot; until everyone falls asleep.
</code></pre>

<p>Notice the lines containing the assignments are not included in the output and that no carriage returns or line feeds are added the the substituted labels.
+ Assign shorthand expansions to a LABEL
    + LABEL :{: SHORTHAND_TO_BE_EXPANDED
    + @content@ :{: @report_name@ @report_date@
        + this would concatenate report name and date</p>

<h3>Processing Markdown pages</h3>

<p><em>shorthand</em> also provides a markdown processor. It uses the <a href="https://github.com/russross/blackfriday">blackfriday</a> markdown library. This is both a convience and also allows you to treat markdown with shorthand assignments as a template that renders HTML or HTML with shorthand ready for expansion. It is a poorman&rsquo;s text rendering engine.</p>

<p>In this example we&rsquo;ll build a HTML page with shorthand labels from markdown text. Then
we will use the render HTML as a template for a blog page entry.</p>

<p>Our markdown file serving as a template will be call &ldquo;post-template.md&rdquo;. It should contain
the outline of the structure of the page plus some shorthand labels we&rsquo;ll expand later.</p>

<pre><code class="language-markdown">
    # @blogTitle

    ## @pageTitle

    ### @dateString

    @contentBlocks

</code></pre>

<p>For the purposes of this exercise we&rsquo;ll use <em>shorthand</em> as a repl and just enter the
assignments sequencly.  Also rather than use the output of shorthand directly we&rsquo;ll
build up the content for the page in a label and use shorthand itself to write the final
page out.</p>

<p>The steps we&rsquo;ll follow will be to</p>

<ol>
<li>Read in our markdown file page.md and turn it into an HTML with embedded shorthand labels</li>
<li>Assign some values to the labels</li>
<li>Expand the labels in the HTML and assign to a new label</li>
<li>Write the new label out to are page call &ldquo;page.html&rdquo;</li>
</ol>

<p>Start the repl with this version of the shorthand command:</p>

<pre><code class="language-shell">    shorthand -p &quot;? &quot;
</code></pre>

<p>The <em>-p</em> option tells <em>shorthand</em> to use the value &ldquo;? &rdquo; as the prompt. When <em>shorthand</em> starts
it will display &ldquo;? &rdquo; to indicate it is ready for an assignment or expansion.</p>

<p>The following assumes you are in the <em>shorthand</em> repl.</p>

<p>Load the mardkown file and transform it into HTML with embedded shorthand labels</p>

<pre><code class="language-shell">    @doctype :!: echo &quot;&lt;!DOCTYPE html&gt;&quot;
    @headBlock :=: &lt;head&gt;&lt;title&gt;@pageTitle&lt;/title&gt;
    @pageTemplate :[&lt;: post-template.md
    @dateString :!: date
    @blogTitle :=:  My Blog
    @pageTitle :=: A Post
    @contentBlock :[&lt;: a-post.md
    @output :{{: @doctype&lt;html&gt;@headBlock&lt;body&gt;@pageTemplate&lt;/body&gt;&lt;/html&gt;
    @output :&gt;: post.html
</code></pre>
</section>
    <nav><ul>
<li><a href="index.html">README</a></li>
<li><a href="shorthand.html">Shorthand details</a></li>
<li><a href="ideas.html">Some background ideas</a></li>
</ul>
</nav>
    <footer>
    shorthand v0.0.4, Mon Sep  7 16:47:51 PDT 2015
<p><p>copyright &copy; 2015 all rights reserved.
Released under the BSD 2-Clause license
See: <a href="http://opensource.org/licenses/BSD-2-Clause">http://opensource.org/licenses/BSD-2-Clause</a></p>

    </footer>
</body>
</html>
